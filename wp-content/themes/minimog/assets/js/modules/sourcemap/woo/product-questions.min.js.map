{"version":3,"sources":["product-questions.js"],"names":["$","Helpers","window","minimog","document","ready","$productQuestion","$noreViews","$questionContainer","$questionList","$productQuestionWrap","$form","body","on","evt","preventDefault","this","$submitBtn","find","$question","questionParentID","parseInt","val","questionCount","html","ajax","url","$minimog","ajaxurl","type","cache","dataType","data","serialize","success","response","questionText","$questionChildList","length","prepend","appendTo","trigger","remove","single_text","plural_text","addClass","text","message","slideDown","beforeSend","removeClass","slideUp","setElementHandling","complete","unsetElementHandling","$thisButton","questionID","$questionModal","$questionModalTitle","$formMessages","$questionParent","questionerName","closest","siblings","children","modalTitle","replace","MinimogModal","fragments","each","key","value","empty","trim","$newElement","parseHTML","setBodyHandling","headerHeight","offset","top","hasClass","outerHeight","animate","scrollTop","setBodyCompleted","linkParams","getUrlParamsAsObject","attr","page","current_page","jQuery"],"mappings":"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","file":"../../../woo/product-questions.min.js","sourcesContent":["(function( $ ) {\n\t'use strict';\n\n\tvar Helpers = window.minimog.Helpers;\n\n\t$( document ).ready( function() {\n\t\tquestionFormHandler();\n\t\treplyHandler();\n\t\tgetProductQuestions();\n\t} );\n\n\tfunction getProductQuestions() {\n\t\tvar $productQuestionWrap = $( '#minimog-wc-question' ),\n\t\t    $form                = $( '.question-search-form', $productQuestionWrap );\n\n\t\t$form.on( 'submit', function( evt ) {\n\t\t\tevt.preventDefault();\n\n\t\t\t$.ajax( {\n\t\t\t\turl: $minimog.ajaxurl,\n\t\t\t\ttype: 'GET',\n\t\t\t\tdata: $form.serialize(),\n\t\t\t\tdataType: 'json',\n\t\t\t\tcache: true,\n\t\t\t\tsuccess: function( response ) {\n\t\t\t\t\tif ( response.data.fragments ) {\n\t\t\t\t\t\t$.each( response.data.fragments, function( key, value ) {\n\t\t\t\t\t\t\t$( key ).empty();\n\n\t\t\t\t\t\t\tif ( '' !== value ) {\n\t\t\t\t\t\t\t\tvalue = $.trim( value );\n\n\t\t\t\t\t\t\t\t/**\n\t\t\t\t\t\t\t\t * Append only children.\n\t\t\t\t\t\t\t\t * Avoid to use replaceWith to lost \"key\" events\n\t\t\t\t\t\t\t\t */\n\t\t\t\t\t\t\t\tvar $newElement = $( $.parseHTML( value ) );\n\t\t\t\t\t\t\t\t$( key ).html( $newElement.html() );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t$( document.body ).trigger( 'minimog_get_product_questions_fragments_loaded' );\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tbeforeSend: function() {\n\t\t\t\t\tHelpers.setBodyHandling();\n\t\t\t\t\tvar $questionToolbar = $( '.question-toolbar', $productQuestionWrap ),\n\t\t\t\t\t    headerHeight     = 0,\n\t\t\t\t\t    offset           = $questionToolbar.offset().top;\n\n\t\t\t\t\tif ( $( document.body ).hasClass( 'header-sticky-enable' ) ) {\n\t\t\t\t\t\theaderHeight = $( '#page-header' ).outerHeight();\n\t\t\t\t\t}\n\n\t\t\t\t\toffset -= headerHeight;\n\t\t\t\t\t$( 'html, body' ).animate( { scrollTop: offset }, 800 );\n\t\t\t\t},\n\t\t\t\tcomplete: function() {\n\t\t\t\t\tHelpers.setBodyCompleted();\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\treturn false;\n\t\t} );\n\n\t\t$( document.body ).on( 'click', '.question-navigation a', function( evt ) {\n\t\t\tevt.preventDefault();\n\n\t\t\tvar linkParams = Helpers.getUrlParamsAsObject( $( this ).attr( 'href' ) );\n\t\t\tvar page       = linkParams ? linkParams.current_page : 1;\n\n\t\t\t$form.find( 'input[name=\"current_page\"]' ).val( page );\n\t\t\t$form.trigger( 'submit' );\n\t\t} );\n\t}\n\n\tfunction questionFormHandler() {\n\t\tvar $productQuestion   = $( '#minimog-wc-question' ),\n\t\t    $noreViews         = $( '.woocommerce-noreviews', $productQuestion ),\n\t\t    $questionContainer = $( '.question-list-container', $productQuestion ),\n\t\t    $questionList      = $( '.question-list', $productQuestion );\n\n\t\t$( document.body ).on( 'submit', '.question-form', function( evt ) {\n\t\t\tevt.preventDefault();\n\n\t\t\tvar $form            = $( this ),\n\t\t\t    $submitBtn       = $form.find( 'button[type=\"submit\"]' ),\n\t\t\t    $question        = $( '[name=question]', $form ),\n\t\t\t    questionParentID = parseInt( $( 'input[name=question_parent_id]', $form ).val() ),\n\t\t\t    questionCount    = parseInt( $( '.question-count', $questionContainer ).html() );\n\n\t\t\t$.ajax( {\n\t\t\t\turl: $minimog.ajaxurl,\n\t\t\t\ttype: 'POST',\n\t\t\t\tcache: false,\n\t\t\t\tdataType: 'json',\n\t\t\t\tdata: $form.serialize(),\n\t\t\t\tsuccess: function( response ) {\n\t\t\t\t\tif ( response.success ) {\n\t\t\t\t\t\tif ( questionParentID ) {\n\t\t\t\t\t\t\tvar $questionChildList = $( '.children', '#li-comment-' + questionParentID );\n\t\t\t\t\t\t\tif ( $questionChildList.length ) {\n\t\t\t\t\t\t\t\t$questionChildList.prepend( response.data.response );\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t$questionChildList = $( '<ol class=\"children\" />' );\n\t\t\t\t\t\t\t\t$questionChildList.appendTo( '#li-comment-' + questionParentID ).html( response.data.response );\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t$( document.body ).trigger( 'minimog_product_question_child_added', [ questionParentID ] );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// Increasing comment count if it is not children comment.\n\t\t\t\t\t\t\tquestionCount = questionCount + 1;\n\n\t\t\t\t\t\t\t// Remove no questions text.\n\t\t\t\t\t\t\tif ( $noreViews.length ) {\n\t\t\t\t\t\t\t\t$noreViews.remove();\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t$questionList.prepend( response.data.response );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvar questionText = questionCount === 1 ? response.data.single_text : response.data.plural_text;\n\n\t\t\t\t\t\t$( '.question-count', $questionContainer ).html( questionCount );\n\t\t\t\t\t\t$( '.question-text', $questionContainer ).html( questionText );\n\n\t\t\t\t\t\t$question.val( '' );\n\t\t\t\t\t\t$( document.body ).trigger( 'minimog_product_question_added', [ response.data, true ] );\n\n\t\t\t\t\t\t$form.find( '.question-form-message-box' ).addClass( 'success' ).text( response.data.message ).slideDown();\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$form.find( '.question-form-message-box' ).addClass( 'failed' ).text( response.data.message ).slideDown();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tbeforeSend: function() {\n\t\t\t\t\t$form.find( '.question-form-message-box' ).text( '' ).removeClass( 'failed success' ).slideUp();\n\t\t\t\t\tHelpers.setElementHandling( $submitBtn );\n\t\t\t\t},\n\t\t\t\tcomplete: function() {\n\t\t\t\t\tHelpers.unsetElementHandling( $submitBtn );\n\t\t\t\t}\n\t\t\t} );\n\t\t} );\n\t}\n\n\tfunction replyHandler() {\n\t\t$( document.body ).on( 'click', '.question-reply', function( evt ) {\n\t\t\tevt.preventDefault();\n\n\t\t\tvar $thisButton         = $( this ),\n\t\t\t    questionID          = $thisButton.data( 'question-id' ),\n\t\t\t    $questionModal      = $( '#modal-product-question' ),\n\t\t\t    $questionModalTitle = $questionModal.find( '.modal-title' ),\n\t\t\t    $formMessages       = $questionModal.find( '.question-form-message-box' ),\n\t\t\t    $questionParent     = $questionModal.find( 'input[name=\"question_parent_id\"]' );\n\n\t\t\tvar questionerName = $thisButton.closest( '.comment-footer' ).siblings( '.meta' ).children( '.fn' ).text();\n\t\t\tvar modalTitle     = $questionModal.data( 'reply-title' );\n\t\t\t$formMessages.removeClass( 'success failed' ).text( '' );\n\n\t\t\tmodalTitle = modalTitle.replace( '{comment_author_name}', questionerName );\n\t\t\t$questionModalTitle.text( modalTitle );\n\t\t\t$questionModal.MinimogModal( 'open' );\n\t\t\t$questionParent.val( questionID );\n\t\t} );\n\t}\n})( jQuery );\n"]}