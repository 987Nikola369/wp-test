{"version":3,"sources":["cart.js"],"names":["$","Helpers","window","minimog","$cartTable","document","ready","timeout","on","$qty","this","get","reportValidity","undefined","clearTimeout","setTimeout","cart_item_key","cart_item_qty","itemKey","attr","itemQty","val","data","security","$minimog","nonce","ajax","url","$minimogWoo","wc_ajax_url","toString","replace","type","cache","dataType","beforeSend","setBodyHandling","error","setBodyCompleted","success","response","fragments","each","key","value","replaceWith","body","trigger","$form","$submitButton","find","notes","order_notes","setElementHandling","complete","unsetElementHandling","closest","MinimogModal","evt","preventDefault","currentTarget","serialize","empty","$newElement","parseHTML","html","$thisButton","wc_add_to_cart_params","getAjaxUrl","output","cart_hash","location","jQuery"],"mappings":"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","file":"../../../woo/cart.min.js","sourcesContent":["(function( $ ) {\n\t'use strict';\n\n\tvar Helpers = window.minimog.Helpers;\n\n\tvar $cartTable = $( '#cart-table-wrap' );\n\n\t$( document ).ready( function() {\n\t\tinitCart();\n\t} );\n\n\t$( document.body ).on( 'wc_fragments_loaded wc_fragments_refreshed', function() {\n\t\tHelpers.setBodyCompleted();\n\t} );\n\n\t$( '#modal-cart-order-notes' ).on( 'submit', 'form', save_order_notes );\n\n\t$( document ).on( 'submit', 'form.fly-cart-shipping-calculator', shipping_calculator_submit );\n\n\t$( document ).on( 'click', '.btn-remove-from-cart', remove_from_cart );\n\n\tfunction initCart() {\n\t\tvar timeout;\n\t\t$cartTable.on( 'change', '.qty', function() {\n\t\t\tvar $qty = $( this );\n\n\t\t\tif ( ! $qty.get( 0 ).reportValidity() ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ( timeout !== undefined ) {\n\t\t\t\tclearTimeout( timeout );\n\t\t\t}\n\n\t\t\ttimeout = setTimeout( function() {\n\t\t\t\tvar itemKey = $qty.attr( 'name' );\n\t\t\t\tvar itemQty = $qty.val();\n\n\t\t\t\tupdate_quantity( itemKey, itemQty );\n\t\t\t}, 500 );\n\t\t} );\n\t}\n\n\tfunction remove_from_cart( evt ) {\n\t\t/**\n\t\t * Check if Enable AJAX add to cart buttons on archives.\n\t\t */\n\t\tif ( typeof wc_add_to_cart_params === 'undefined' ) {\n\t\t\treturn;\n\t\t}\n\n\t\tevt.preventDefault();\n\n\t\tvar $thisButton = $( this );\n\n\t\t$.ajax( {\n\t\t\ttype: 'POST',\n\t\t\turl: Helpers.getAjaxUrl( 'remove_from_cart' ),\n\t\t\tdata: {\n\t\t\t\tcart_item_key: $thisButton.data( 'cart_item_key' )\n\t\t\t},\n\t\t\tdataType: 'json',\n\t\t\tbeforeSend: function() {\n\t\t\t\tHelpers.setBodyHandling();\n\t\t\t},\n\t\t\tsuccess: function( response ) {\n\t\t\t\tif ( ! response || ! response.fragments ) {\n\t\t\t\t\twindow.location = $thisButton.attr( 'href' );\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// Updated cart content.\n\t\t\t\tif ( response.output ) {\n\t\t\t\t\t$.each( response.output, function( key, value ) {\n\t\t\t\t\t\t$( key ).replaceWith( value );\n\t\t\t\t\t} );\n\t\t\t\t}\n\n\t\t\t\t$( document.body ).trigger( 'removed_from_cart', [\n\t\t\t\t\tresponse.fragments, response.cart_hash, $thisButton\n\t\t\t\t] );\n\n\t\t\t\tHelpers.setBodyCompleted();\n\t\t\t},\n\t\t\terror: function() {\n\t\t\t\twindow.location = $thisButton.attr( 'href' );\n\t\t\t\treturn;\n\t\t\t}\n\t\t} );\n\t}\n\n\tfunction update_quantity( cart_item_key, cart_item_qty ) {\n\t\tvar data = {\n\t\t\tcart_item_key: cart_item_key,\n\t\t\tcart_item_qty: cart_item_qty,\n\t\t\tsecurity: $minimog.nonce,\n\t\t};\n\n\t\t$.ajax( {\n\t\t\turl: $minimogWoo.wc_ajax_url.toString().replace( '%%endpoint%%', 'minimog_update_product_quantity' ),\n\t\t\ttype: 'POST',\n\t\t\tcache: false,\n\t\t\tdataType: 'json',\n\t\t\tdata: data,\n\t\t\tbeforeSend: function() {\n\t\t\t\tHelpers.setBodyHandling();\n\t\t\t},\n\t\t\terror: function() {\n\t\t\t\tHelpers.setBodyCompleted();\n\t\t\t},\n\t\t\tsuccess: function( response ) {\n\t\t\t\tif ( response.data && response.data.fragments ) {\n\t\t\t\t\t$.each( response.data.fragments, function( key, value ) {\n\t\t\t\t\t\t$( key ).replaceWith( value );\n\t\t\t\t\t} );\n\t\t\t\t}\n\n\t\t\t\t$( document.body ).trigger( 'minimog_update_qty', [ cart_item_key, cart_item_qty ] );\n\n\t\t\t\t$( document.body ).trigger( 'wc_fragment_refresh' );\n\t\t\t},\n\t\t} );\n\t}\n\n\tfunction save_order_notes() {\n\t\tvar $form         = $( this );\n\t\tvar $submitButton = $form.find( 'button[type=submit]' );\n\n\t\tvar notes = $( this ).find( 'textarea[name=\"order_comments\"]' ).val();\n\n\t\tvar data = {\n\t\t\torder_notes: notes,\n\t\t};\n\n\t\t$.ajax( {\n\t\t\ttype: 'POST',\n\t\t\turl: $minimogWoo.wc_ajax_url.toString().replace( '%%endpoint%%', 'minimog_save_order_notes' ),\n\t\t\tdata: data,\n\t\t\tdataType: 'json',\n\t\t\tsuccess: function( response ) {\n\t\t\t\tif ( response.data && response.data.fragments ) {\n\t\t\t\t\t$.each( response.data.fragments, function( key, value ) {\n\t\t\t\t\t\t$( key ).replaceWith( value );\n\t\t\t\t\t} );\n\t\t\t\t}\n\n\t\t\t\t// Sync notes on other places.\n\t\t\t\t$( 'textarea[name=\"order_comments\"]' ).val( notes );\n\t\t\t},\n\t\t\tbeforeSend: function() {\n\t\t\t\tHelpers.setElementHandling( $submitButton );\n\t\t\t},\n\t\t\tcomplete: function() {\n\t\t\t\tHelpers.unsetElementHandling( $submitButton );\n\t\t\t\t$form.closest( '.minimog-modal' ).MinimogModal( 'close' );\n\t\t\t}\n\t\t} );\n\n\t\treturn false;\n\t}\n\n\t/**\n\t * Clone from wc-cart\n\t * Handles a shipping calculator form submit.\n\t *\n\t * @param {Object} evt The JQuery event.\n\t */\n\tfunction shipping_calculator_submit( evt ) {\n\t\tevt.preventDefault();\n\n\t\tvar $form = $( evt.currentTarget );\n\n\t\t$.ajax( {\n\t\t\ttype: $form.attr( 'method' ),\n\t\t\turl: $minimogWoo.wc_ajax_url.toString().replace( '%%endpoint%%', 'minimog_calculate_shipping' ),\n\t\t\tdata: $form.serialize(),\n\t\t\tdataType: 'json',\n\t\t\tsuccess: function( response ) {\n\t\t\t\tif ( response.data.fragments ) {\n\t\t\t\t\t$.each( response.data.fragments, function( key, value ) {\n\t\t\t\t\t\t$( key ).empty();\n\n\t\t\t\t\t\tif ( '' !== value ) {\n\t\t\t\t\t\t\t/**\n\t\t\t\t\t\t\t * Append only children.\n\t\t\t\t\t\t\t * Avoid to use replaceWith to lost \"key\" events\n\t\t\t\t\t\t\t */\n\t\t\t\t\t\t\tvar $newElement = $( $.parseHTML( value ) );\n\t\t\t\t\t\t\t$( key ).html( $newElement.html() );\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t},\n\t\t\tbeforeSend: function() {\n\t\t\t\t$form.closest( '.minimog-modal' ).MinimogModal( 'close' );\n\t\t\t\tHelpers.setBodyHandling();\n\t\t\t},\n\t\t\tcomplete: function() {\n\t\t\t\tHelpers.setBodyCompleted();\n\t\t\t}\n\t\t} );\n\t}\n}( jQuery ));\n"]}