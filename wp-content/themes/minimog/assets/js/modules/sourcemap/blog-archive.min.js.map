{"version":3,"sources":["blog-archive.js"],"names":["$","$pageSidebars","Helpers","window","minimog","filterPostsByUrl","url","options","settings","extend","loadMore","scrollTop","$btnLoadMore","decodeURIComponent","history","pushState","ajax","type","dataType","success","response","$response","$gridWrapper","$grid","children","$newItems","remove","find","fragments","data","MinimogGridLayout","append","each","push","this","attr","let","i","totalFragments","length","key","$key","empty","$newElement","html","document","body","trigger","offsetTop","offset","top","Math","max","animate","$thisSidebar","hasClass","stop","slideDown","fn","perfectScrollbar","isHandheld","beforeSend","setElementHandling","setBodyHandling","complete","unsetElementHandling","setBodyCompleted","ready","lastST","$window","$el","on","$button","currentST","halfWH","height","parseInt","outerHeight","evt","preventDefault","href","includes","location","origin","jQuery"],"mappings":"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","file":"../../blog-archive.min.js","sourcesContent":["/**\n * Functions for archive pages.\n */\n(function( $ ) {\n\t'use strict';\n\n\tvar $body             = $( 'body' ),\n\t    $pageSidebars     = $( '.page-sidebar' ),\n\t    Helpers           = window.minimog.Helpers,\n\t    collapseDuration  = 250,\n\t    COLLAPSED_CLASS   = 'collapsed',\n\t    COLLAPSIBLE_CLASS = 'sidebar-widgets-collapsible';\n\n\t$( document ).ready( function() {\n\t\tinitBlogMasonry();\n\t\thandlerScrollInfinite();\n\n\t\t$( document.body ).on( 'click', '.minimog-grid-pagination a.page-numbers', function( evt ) {\n\t\t\tevt.preventDefault();\n\n\t\t\tvar $link = $( this ),\n\t\t\t    href  = $link.attr( 'href' ),\n\t\t\t    url   = href.includes( window.location.origin ) ? href : window.location.origin + href;\n\n\t\t\tfilterPostsByUrl( url, { scrollTop: 1 } );\n\t\t} );\n\n\t\t$( document.body ).on( 'click', '.archive-load-more-button', function( evt ) {\n\t\t\tevt.preventDefault();\n\n\t\t\tvar $button = $( this ),\n\t\t\t    href    = $button.attr( 'data-url' ),\n\t\t\t    url     = href.includes( window.location.origin ) ? href : window.location.origin + href;\n\n\t\t\tfilterPostsByUrl( url, { loadMore: 1 } );\n\t\t} );\n\t} );\n\n\tfunction filterPostsByUrl( url, options = {} ) {\n\t\tvar settings = $.extend( true, {}, {\n\t\t\tloadMore: 0,\n\t\t\tscrollTop: 0\n\t\t}, options );\n\n\t\turl = decodeURIComponent( url );\n\n\t\tif ( ! settings.loadMore ) {\n\t\t\thistory.pushState( {}, null, url );\n\t\t}\n\n\t\tvar $btnLoadMore = $( '.archive-load-more-button' );\n\n\t\t$.ajax( {\n\t\t\turl: url,\n\t\t\ttype: 'GET',\n\t\t\tdataType: 'html',\n\t\t\tsuccess: function( response ) {\n\t\t\t\tvar $response = $( response );\n\n\t\t\t\tvar $gridWrapper = $( '#minimog-main-post' ),\n\t\t\t\t    $grid        = $gridWrapper.children( '.minimog-grid' );\n\n\t\t\t\tif ( ! settings.loadMore ) {\n\t\t\t\t\t$grid.children( '.grid-item' ).remove();\n\t\t\t\t}\n\n\t\t\t\tvar $newItems = $response.find( '#minimog-main-post .grid-item' );\n\t\t\t\tif ( $gridWrapper.data( 'minimogGridLayout' ) ) {\n\t\t\t\t\t$gridWrapper.MinimogGridLayout( 'update', $newItems );\n\t\t\t\t} else {\n\t\t\t\t\t$grid.append( $newItems );\n\t\t\t\t}\n\n\t\t\t\tvar fragments = [\n\t\t\t\t\t'.minimog-grid-pagination',\n\t\t\t\t];\n\n\t\t\t\tvar $filterWidgets = $( '.minimog-wp-widget-filter' );\n\n\t\t\t\t$filterWidgets.each( function() {\n\t\t\t\t\tfragments.push( '#' + $( this ).attr( 'id' ) );\n\t\t\t\t} );\n\n\t\t\t\tfor ( let i = 0, totalFragments = fragments.length; i < totalFragments; i ++ ) {\n\t\t\t\t\tvar key  = fragments[i],\n\t\t\t\t\t    $key = $( key );\n\n\t\t\t\t\tif ( $key.length > 0 ) {\n\t\t\t\t\t\t$key.empty();\n\t\t\t\t\t\tvar $newElement = $response.find( key );\n\t\t\t\t\t\tif ( $newElement.length > 0 ) {\n\t\t\t\t\t\t\t$key.html( $newElement.html() );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t$( document.body ).trigger( 'minimog_get_post_fragments_loaded', [ $response ] );\n\n\t\t\t\tif ( settings.scrollTop ) {\n\t\t\t\t\tvar offsetTop = $gridWrapper.offset().top;\n\t\t\t\t\toffsetTop -= 198; // Header + topbar + filter bar.\n\t\t\t\t\toffsetTop     = Math.max( 0, offsetTop );\n\n\t\t\t\t\t$( 'html, body' ).animate( { scrollTop: offsetTop }, 300 );\n\t\t\t\t}\n\n\t\t\t\t// Disable collapse if it opens before.\n\t\t\t\t$pageSidebars.each( function() {\n\t\t\t\t\tvar $thisSidebar = $( this );\n\t\t\t\t\tif ( $thisSidebar.hasClass( COLLAPSIBLE_CLASS ) ) {\n\t\t\t\t\t\t$thisSidebar.find( '.widget:not(.' + COLLAPSED_CLASS + ')' ).find( '.widget-content' ).stop().slideDown( collapseDuration );\n\t\t\t\t\t}\n\t\t\t\t} );\n\n\t\t\t\t// Update Widget Scrollable size.\n\t\t\t\tif ( $.fn.perfectScrollbar && ! Helpers.isHandheld() ) {\n\t\t\t\t\t$pageSidebars.find( '.widget-scrollable' ).each( function() {\n\t\t\t\t\t\t$( this ).find( '.widget-content-inner' ).perfectScrollbar( 'update' );\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t},\n\t\t\tbeforeSend: function() {\n\t\t\t\tif ( settings.loadMore ) {\n\t\t\t\t\tHelpers.setElementHandling( $btnLoadMore );\n\t\t\t\t} else {\n\t\t\t\t\tHelpers.setBodyHandling();\n\t\t\t\t}\n\t\t\t},\n\t\t\tcomplete: function() {\n\t\t\t\tif ( settings.loadMore ) {\n\t\t\t\t\tHelpers.unsetElementHandling( $btnLoadMore );\n\t\t\t\t} else {\n\t\t\t\t\tHelpers.setBodyCompleted();\n\t\t\t\t}\n\t\t\t}\n\t\t} );\n\t}\n\n\tfunction handlerScrollInfinite() {\n\t\tvar $el = $( '.minimog-grid-pagination' );\n\n\t\tif ( 'infinite' !== $el.data( 'type' ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar lastST  = 0;\n\t\tvar $window = $( window );\n\n\t\t$window.on( 'scroll', function() {\n\t\t\tvar currentST = $( this ).scrollTop();\n\n\t\t\t// Scroll down only.\n\t\t\tif ( currentST > lastST ) {\n\t\t\t\tvar windowHeight = $window.height();\n\t\t\t\t// 90% window height.\n\t\t\t\tvar halfWH       = 90 / 100 * windowHeight;\n\t\t\t\thalfWH           = parseInt( halfWH );\n\n\t\t\t\tvar elOffsetTop = $el.offset().top;\n\t\t\t\tvar elHeight    = $el.outerHeight( true );\n\t\t\t\tvar offsetTop   = elOffsetTop + elHeight;\n\t\t\t\tvar finalOffset = offsetTop - halfWH;\n\n\t\t\t\tif ( currentST >= finalOffset ) {\n\t\t\t\t\tvar $button = $el.find( '.archive-load-more-button' );\n\n\t\t\t\t\tif ( ! $button.hasClass( 'updating-icon' ) ) {\n\t\t\t\t\t\t$button.trigger( 'click' );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlastST = currentST;\n\t\t} );\n\t}\n\n\tfunction initBlogMasonry() {\n\t\tif ( $.fn.MinimogGridLayout ) {\n\t\t\tvar $gridWrapper = $( '#minimog-main-post' );\n\n\t\t\tif ( $gridWrapper.hasClass( 'minimog-grid-masonry' ) ) {\n\t\t\t\t$gridWrapper.MinimogGridLayout();\n\t\t\t}\n\t\t}\n\t}\n\n}( jQuery ));\n"]}