{"version":3,"sources":["m-image.js"],"names":["MinimogImageLoading","HTMLElement","intersecting","this","hasAttribute","constructor","super","img","querySelector","observerCallback","bind","loadImage","onload","onLoad","complete","setLoadedStage","connectedCallback","window","initIntersectionObserver","disconnectedCallback","disconnectObserver","setAttribute","removeAttribute","classList","add","entries","observer","isIntersecting","unobserve","IntersectionObserver","rootMargin","observe","disconnect","MinimogImage","customElements","define","MinimogBackgroundImage"],"mappings":"MAAAA,4BAAAC,YACAC,mBACA,OAAAC,KAAAC,aAAA,cAAA,CACA,CAEAC,cACAC,MAAA,EACAH,KAAAI,IAAAJ,KAAAK,cAAA,KAAA,EACAL,KAAAM,iBAAAN,KAAAM,iBAAAC,KAAAP,IAAA,EACAA,KAAAQ,UAAAR,KAAAQ,UAAAD,KAAAP,IAAA,EACAA,KAAAI,IAAAK,OAAAT,KAAAU,OAAAH,KAAAP,IAAA,EACAA,KAAAI,IAAAO,UACAX,KAAAY,eAAA,CAEA,CAEAC,oBACA,yBAAAC,OACAd,KAAAe,yBAAA,EAEAf,KAAAQ,UAAA,CAEA,CAEAQ,uBACAhB,KAAAiB,mBAAA,CACA,CAEAT,YACAR,KAAAkB,aAAA,eAAA,MAAA,CACA,CAEAR,SACAV,KAAAY,eAAA,CACA,CAEAA,iBACAZ,KAAAmB,gBAAA,oBAAA,EACAnB,KAAAoB,UAAAC,IAAA,cAAA,CACA,CAEAf,iBAAAgB,EAAAC,GACAD,EAAA,GAAAE,iBAGAD,EAAAE,UAAAzB,IAAA,EACAA,KAAAQ,UAAA,EACA,CAEAO,2BACAf,KAAAuB,WAIAvB,KAAAuB,SAAA,IAAAG,qBAAA1B,KAAAM,iBAAA,CAAAqB,WADA,MACA,CAAA,EACA3B,KAAAuB,SAAAK,QAAA5B,IAAA,EACA,CAEAiB,qBACAjB,KAAAuB,WAGAvB,KAAAuB,SAAAM,WAAA,EACA7B,KAAAuB,SAAA,KACA,OAAAvB,KAAAuB,SACA,CACA,OAEAO,qBAAAjC,oBACAK,cACAC,MAAA,CACA,CAEAS,iBACAZ,KAAAmB,gBAAA,oBAAA,EACAnB,KAAAoB,UAAAC,IAAA,cAAA,CACA,CACA,CAEAU,eAAAC,OAAA,UAAAF,YAAA,QAEAG,+BAAApC,oBACAK,cACAC,MAAA,CACA,CAEAS,iBACAZ,KAAAmB,gBAAA,yBAAA,EACAnB,KAAAoB,UAAAC,IAAA,qBAAA,CACA,CACA,CAEAU,eAAAC,OAAA,eAAAC,sBAAA","file":"../../m-image.min.js","sourcesContent":["class MinimogImageLoading extends HTMLElement {\n\tget intersecting() {\n\t\treturn this.hasAttribute( 'intersecting' )\n\t}\n\n\tconstructor() {\n\t\tsuper()\n\t\tthis.img              = this.querySelector( 'img' )\n\t\tthis.observerCallback = this.observerCallback.bind( this )\n\t\tthis.loadImage        = this.loadImage.bind( this )\n\t\tthis.img.onload       = this.onLoad.bind( this )\n\t\tif ( this.img.complete ) {\n\t\t\tthis.setLoadedStage()\n\t\t}\n\t}\n\n\tconnectedCallback() {\n\t\tif ( 'IntersectionObserver' in window ) {\n\t\t\tthis.initIntersectionObserver()\n\t\t} else {\n\t\t\tthis.loadImage()\n\t\t}\n\t}\n\n\tdisconnectedCallback() {\n\t\tthis.disconnectObserver()\n\t}\n\n\tloadImage() {\n\t\tthis.setAttribute( 'intersecting', 'true' )\n\t}\n\n\tonLoad() {\n\t\tthis.setLoadedStage();\n\t}\n\n\tsetLoadedStage() {\n\t\tthis.removeAttribute( 'data-image-loading' )\n\t\tthis.classList.add( 'm-img-loaded' )\n\t}\n\n\tobserverCallback( entries, observer ) {\n\t\tif ( ! entries[0].isIntersecting ) {\n\t\t\treturn;\n\t\t}\n\t\tobserver.unobserve( this );\n\t\tthis.loadImage()\n\t}\n\n\tinitIntersectionObserver() {\n\t\tif ( this.observer ) {\n\t\t\treturn\n\t\t}\n\t\tconst rootMargin = '10px';\n\t\tthis.observer    = new IntersectionObserver( this.observerCallback, { rootMargin } )\n\t\tthis.observer.observe( this )\n\t}\n\n\tdisconnectObserver() {\n\t\tif ( ! this.observer ) {\n\t\t\treturn\n\t\t}\n\t\tthis.observer.disconnect()\n\t\tthis.observer = null\n\t\tdelete this.observer\n\t}\n}\n\nclass MinimogImage extends MinimogImageLoading {\n\tconstructor() {\n\t\tsuper()\n\t}\n\n\tsetLoadedStage() {\n\t\tthis.removeAttribute( 'data-image-loading' )\n\t\tthis.classList.add( 'm-img-loaded' )\n\t}\n}\n\ncustomElements.define( 'm-image', MinimogImage )\n\nclass MinimogBackgroundImage extends MinimogImageLoading {\n\tconstructor() {\n\t\tsuper()\n\t}\n\n\tsetLoadedStage() {\n\t\tthis.removeAttribute( 'data-background-loading' )\n\t\tthis.classList.add( 'm-background-loaded' )\n\t}\n}\n\ncustomElements.define( 'm-background', MinimogBackgroundImage )\n\n"]}